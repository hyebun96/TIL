# SAML(Security Assertion Markup Language)

인증 정보 제공자와 서비스 제공자 간의 인증 및 인가 데이터를 교환하기 위한 XML 기반의 개방형 표준 데이터 포맷이다.  

SAML은 네트워크를 통해 여러 컴퓨터에서 보안 자격 증명을 공유 할 수 있도록 하는 공개 표준이다. 한대의 컴퓨터가 하나 이상의 다른 컴퓨터를 대신해 몇 가지 보안 기능을 수행할 수 있도록 하는 프레임워크를 설명한다.

SAML은 SSO(Single Sign-On)를 구현하는 한 가지 방법이며, 실제 SSO는 SAML의 가장 일반적인 사용사례이다.

- **인증(Authentication)** : 사용자가 자신이 주장하는 사람임을 확인
- **권한 부여(Authentication)** : 사용자가 특정 시스템이나 콘텐츠에 접속 할 수있는 권한이 있는지 확인

엄밀히 말하면 SAML은 모든 정보를 인코딩 하는데 사용되는 XML 변형 언어를 의미한다. 이 용어는 표준의 일부를 구성하는 다양한 프로토콜 메세지와 프로파일을 포함할 수 있다.
<br/>

### SAML 공급자(Provider)
시스템에서 사용자가 원하는 서비스에 접속할 수 있도록 도와주는 개체이다. (일반적으로 서버나 컴퓨터를 의미한다.) SAML서비스를 제공하거나 사용하는 시스템을 일컫는데, 가장 중요한 서비스 공급자는 ID 공급자이다.

ID공급자는 시스템 내 개체로, 실제로 사용자가 자신이 주장하는 사람인지 확인하는 역할을 한다. 즉, 인증을 제공한다. 또한 사용자가 시스템의 다양한 개체를 통해 접속할 권한이 있는 서비스인지를 결정할 수있다.  SAML 표준에 따라 인증 서비스를 제공할 수 있는 다양한 구현있다.

⇒ 예를 들어, 세일즈포스는 LDAP, RADIUS 또는 디렉터리와 같은 규칙을 제공한다.
<br/>

### SAML 어선셜(assertion)
SAML 어설션(assertion)은 지금까지 얘기한 모든 정보가 한 컴퓨터에서 다른 컴퓨터로 전송되는 XML문서이다. ID공급자가 자신이 말하는 사람이고 자신이 관심있는 콘텐츠나 서비스에 접속할 권한이 있다고 결정하면 SAML 어설션을 서버에 보내 실제로 해당 서비스를 제공할 수 있다. SAML어설션은 향상된 보안을 위해 암호화 할 수있다.
<br/>

### SAML 트랜잭션
SSO 환경의 사용자이고 서버의 일부 리소스에 접속하려 한다고 가정했을때, 일련의 이벤트 과정

(1) 서비스 제공자인 SAML은 서버의 자원에 접속하려고 시도한다. 서비스 제공자는 시스템에서 이미 인증 됐는지 확인한다. 이미 인증됐다면 바로 7단계로 건너뛴다. 그렇지 않은 경우 서비스 공급자는 인증 프로세스를 시작한다.

(2) 서비스 공급자가 적절한 신원 공급자를 결정하고 해당 공급자를 리디랙션한다. (지금 사례의 경우, 서비스 공급자는 인증 프로세스를 의미한다.)

(3) 브라우저가 SSO서비스는 서비스 공급자가 SAMLResponse 매개 변수에 필요로 하는 인증 정보를 포함하는 XHTML문서를 반환한다.

(4) SSO서비스는 서비스 공급자가 SAMLResponse 매개 변수에 필요로 하는 인증 정보를 포함하는 XHTML 문서를 반환한다.

(5) SAMLResponse 매개 변수가 서비스 제공자에게 전달된다.

(6) 서비스 공급자는 이 응답을 처리하고 사용자를 위해 보안 컨텍스트 작성한다. 기본적을 사용자가 로그인하고 요청한 리소스를 다시 요청할 수 있다.

(7) 이 정보를 이용해 관심있는 리소스를 다시 요청할 수 있다.

(8) 리소스가 반환된다.
